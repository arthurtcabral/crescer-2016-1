--1
SELECT 
CL.IDCLIENTE, 
CL.NOME as Cliente,
CI.NOME as Cidade,
CI.UF
FROM CLIENTE CL
INNER JOIN CIDADE CI
ON CI.IDCIDADE = CL.IDCIDADE;

--2
SELECT COUNT(*) FROM PEDIDO WHERE DATAPEDIDO BETWEEN TO_DATE('01/05/16') AND TO_DATE('01/06/16');

--3
SELECT * FROM CLIENTE WHERE UPPER(NOME) LIKE '%LTDA%' OR UPPER(RAZAOSOCIAL) LIKE '%LTDA%';

--4

SELECT MAX(IDPRODUTO) FROM PRODUTO;
CREATE SEQUENCE SQLPRODUTO START WITH 8001;

INSERT INTO PRODUTO (IDPRODUTO, NOME, PRECOCUSTO, PRECOVENDA, SITUACAO)
VALUES
(SQLPRODUTO.NEXTVAL, 'Galocha Maragato', 35.67, 77.95, 'A');

COMMIT;

--5

SELECT prod.* FROM PRODUTO prod
LEFT JOIN
PEDIDOITEM pi
ON
prod.IDPRODUTO = pi.IDPRODUTO
WHERE pi.IDPEDIDOITEM is null;

--6

SELECT pi.QUANTIDADE, pi.PRECOUNITARIO, pe.DATAPEDIDO, prod.NOME FROM PEDIDOITEM pi
INNER JOIN PEDIDO pe ON pi.IDPEDIDO = pe.IDPEDIDO
INNER JOIN PRODUTO prod ON prod.IDPRODUTO = pi.IDPRODUTO
WHERE pe.IDCLIENTE = :pIDCLIENTE;

--7

SELECT SUM(pi.Quantidade) FROM PedidoItem pi
INNER JOIN Produto prod ON pi.IDProduto = prod.IDProduto
INNER JOIN Pedido pe ON pe.IDPedido = pi.IDPedido
WHERE pe.DATAPEDIDO BETWEEN TO_DATE('01/01/16','dd/MM/yyyy')
AND CURRENT_TIMESTAMP
AND prod.IDProduto = :pIDProduto;

--8

SELECT TO_CHAR(pe.DataPedido, 'mm/yyyy') Dat,
COUNT(DISTINCT pi.IDProduto) Produtos,
SUM(pe.ValorPedido) Valor_Pedidos,
MIN(pe.ValorPedido) Menor_Valor_Pedido,
MAX(pe.ValorPedido) Maior_Valor_Pedido,
ROUND(AVG(pe.ValorPedido), 2) Media_Valores,
COUNT(DISTINCT pe.IDPedido) Total_Pedidos
FROM Pedido pe
INNER JOIN PedidoItem pi ON pi.IDPedido = pe.IDPedido
GROUP BY TO_CHAR(pe.DataPedido, 'mm/yyyy');